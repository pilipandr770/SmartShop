{% extends 'admin/layout.html' %}
{% block title %}AI –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è - –ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å{% endblock %}
{% block content %}
<div class="page-header">
    <h1>ü§ñ AI –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</h1>
    <p class="page-subtitle">–ö–µ—Ä—É–≤–∞–Ω–Ω—è —á–∞—Ç–±–æ—Ç–æ–º —Ç–∞ AI-–±–ª–æ–≥–µ—Ä–æ–º</p>
</div>

<form method="post">
    <!-- –ù–∞–≤—ñ–≥–∞—Ü—ñ—è –ø–æ —Ç–∞–±–∞—Ö -->
    <div class="tabs">
        <button type="button" class="tab active" onclick="showTab('chatbot')">üí¨ –ß–∞—Ç–±–æ—Ç</button>
        <button type="button" class="tab" onclick="showTab('blogger')">üìù AI –ë–ª–æ–≥–µ—Ä</button>
    </div>
    
    <!-- Tab: –ß–∞—Ç–±–æ—Ç -->
    <div id="tab-chatbot" class="tab-content active">
        <div class="cards-grid">
            <div class="card">
                <div class="card-header">
                    <h3>‚öôÔ∏è –û—Å–Ω–æ–≤–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</h3>
                </div>
                <div class="form-section">
                    <div class="form-group">
                        <label class="toggle-label">
                            <input type="checkbox" name="chatbot_enabled" {{ 'checked' if ai_settings.chatbot_enabled else '' }}>
                            <span class="toggle-switch"></span>
                            –ß–∞—Ç–±–æ—Ç —É–≤—ñ–º–∫–Ω–µ–Ω–æ
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="chatbot_name">–Ü–º'—è —á–∞—Ç–±–æ—Ç–∞</label>
                        <input type="text" id="chatbot_name" name="chatbot_name" 
                               value="{{ ai_settings.chatbot_name or '–Ü–Ü-–ø—Ä–æ–¥–∞–≤–µ—Ü—å' }}" placeholder="–Ü–Ü-–ø—Ä–æ–¥–∞–≤–µ—Ü—å">
                    </div>
                    <div class="form-group">
                        <label for="chatbot_tone">–¢–æ–Ω —Å–ø—ñ–ª–∫—É–≤–∞–Ω–Ω—è</label>
                        <select id="chatbot_tone" name="chatbot_tone">
                            <option value="friendly" {{ 'selected' if ai_settings.chatbot_tone == 'friendly' else '' }}>üòä –î—Ä—É–∂–Ω—ñ–π</option>
                            <option value="professional" {{ 'selected' if ai_settings.chatbot_tone == 'professional' else '' }}>üëî –ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π</option>
                            <option value="casual" {{ 'selected' if ai_settings.chatbot_tone == 'casual' else '' }}>üòé –ù–µ—Ñ–æ—Ä–º–∞–ª—å–Ω–∏–π</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3>üîß –¢–µ—Ö–Ω—ñ—á–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏</h3>
                </div>
                <div class="form-section">
                    <div class="form-group">
                        <label for="chatbot_max_tokens">–ú–∞–∫—Å–∏–º—É–º —Ç–æ–∫–µ–Ω—ñ–≤ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ</label>
                        <input type="number" id="chatbot_max_tokens" name="chatbot_max_tokens" 
                               value="{{ ai_settings.chatbot_max_tokens or 500 }}" min="100" max="2000">
                        <small class="form-hint">–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ: 300-800</small>
                    </div>
                    <div class="form-group">
                        <label for="chatbot_temperature">–ö—Ä–µ–∞—Ç–∏–≤–Ω—ñ—Å—Ç—å (0-1)</label>
                        <input type="range" id="chatbot_temperature" name="chatbot_temperature" 
                               value="{{ ai_settings.chatbot_temperature or 0.7 }}" min="0" max="1" step="0.1"
                               oninput="document.getElementById('temp-value').textContent = this.value">
                        <span id="temp-value">{{ ai_settings.chatbot_temperature or 0.7 }}</span>
                        <small class="form-hint">0 = —Ç–æ—á–Ω–∏–π, 1 = –∫—Ä–µ–∞—Ç–∏–≤–Ω–∏–π</small>
                    </div>
                </div>
            </div>
        </div>

        <div class="card" style="margin-top: 1.5rem;">
            <div class="card-header">
                <h3>üìã –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è —á–∞—Ç–±–æ—Ç–∞</h3>
            </div>
            <div class="form-section">
                <div class="form-group">
                    <label for="chatbot_system_prompt">–ë–∞–∑–æ–≤–∏–π —Å–∏—Å—Ç–µ–º–Ω–∏–π –ø—Ä–æ–º–ø—Ç</label>
                    <textarea id="chatbot_system_prompt" name="chatbot_system_prompt" rows="6" 
                              placeholder="–û—Å–Ω–æ–≤–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞ —Ä–æ–±–æ—Ç–∏ —á–∞—Ç–±–æ—Ç–∞...">{{ ai_settings.chatbot_system_prompt or '' }}</textarea>
                    <small class="form-hint">–ë–∞–∑–æ–≤—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó, —è–∫—ñ –∑–∞–≤–∂–¥–∏ –≤–∫–ª—é—á–∞—é—Ç—å—Å—è</small>
                </div>
                <div class="form-group">
                    <label for="chatbot_custom_instructions">üéØ –ö–∞—Å—Ç–æ–º–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –≤—ñ–¥ –∞–¥–º—ñ–Ω–∞</label>
                    <textarea id="chatbot_custom_instructions" name="chatbot_custom_instructions" rows="8" 
                              placeholder="–í–≤–µ–¥—ñ—Ç—å –≤–∞—à—ñ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è —á–∞—Ç–±–æ—Ç–∞...

–ù–∞–ø—Ä–∏–∫–ª–∞–¥:
- –ó–∞–≤–∂–¥–∏ –ø—Ä–æ–ø–æ–Ω—É–π —Ç–æ–≤–∞—Ä–∏ –∑—ñ –∑–Ω–∏–∂–∫–æ—é
- –ó–≥–∞–¥—É–π –ø—Ä–æ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω—É –¥–æ—Å—Ç–∞–≤–∫—É –≤—ñ–¥ 1000 –≥—Ä–Ω
- –ü—Ä–∏ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è—Ö –ø—Ä–æ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ñ–≤ –ø–µ—Ä–µ–≤–æ–¥—å –Ω–∞ –Ω–∞—à—ñ –ø–µ—Ä–µ–≤–∞–≥–∏
- –ù–µ –æ–±–≥–æ–≤–æ—Ä—é–π –ø–æ–ª—ñ—Ç–∏–∫—É —Ç–∞ —Ä–µ–ª—ñ–≥—ñ—é">{{ ai_settings.chatbot_custom_instructions or '' }}</textarea>
                    <small class="form-hint">üí° –¶—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–æ–¥–∞—é—Ç—å—Å—è –¥–æ –±–∞–∑–æ–≤–æ–≥–æ –ø—Ä–æ–º–ø—Ç—É. –ë–æ—Ç –±—É–¥–µ —ó—Ö –≤—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –ø—Ä–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—è—Ö.</small>
                </div>
                <div class="form-group">
                    <label for="chatbot_forbidden_topics">üö´ –ó–∞–±–æ—Ä–æ–Ω–µ–Ω—ñ —Ç–µ–º–∏</label>
                    <textarea id="chatbot_forbidden_topics" name="chatbot_forbidden_topics" rows="3" 
                              placeholder="–ü–æ–ª—ñ—Ç–∏–∫–∞, —Ä–µ–ª—ñ–≥—ñ—è, –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∏...">{{ ai_settings.chatbot_forbidden_topics or '' }}</textarea>
                    <small class="form-hint">–¢–µ–º–∏, –Ω–∞ —è–∫—ñ –±–æ—Ç –≤—ñ–¥–º–æ–≤–∏—Ç—å—Å—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏</small>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Tab: AI –ë–ª–æ–≥–µ—Ä -->
    <div id="tab-blogger" class="tab-content">
        <div class="cards-grid">
            <div class="card">
                <div class="card-header">
                    <h3>‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–ª–æ–≥–µ—Ä–∞</h3>
                </div>
                <div class="form-section">
                    <div class="form-group">
                        <label class="toggle-label">
                            <input type="checkbox" name="blogger_enabled" {{ 'checked' if ai_settings.blogger_enabled else '' }}>
                            <span class="toggle-switch"></span>
                            AI –ë–ª–æ–≥–µ—Ä —É–≤—ñ–º–∫–Ω–µ–Ω–æ
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="blogger_name">–Ü–º'—è –∞–≤—Ç–æ—Ä–∞</label>
                        <input type="text" id="blogger_name" name="blogger_name" 
                               value="{{ ai_settings.blogger_name or 'AI –ë–ª–æ–≥–µ—Ä' }}" placeholder="AI –ë–ª–æ–≥–µ—Ä">
                    </div>
                    <div class="form-group">
                        <label for="blogger_style">–°—Ç–∏–ª—å –Ω–∞–ø–∏—Å–∞–Ω–Ω—è</label>
                        <select id="blogger_style" name="blogger_style">
                            <option value="informative" {{ 'selected' if ai_settings.blogger_style == 'informative' else '' }}>üìö –Ü–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–∏–π</option>
                            <option value="entertaining" {{ 'selected' if ai_settings.blogger_style == 'entertaining' else '' }}>üé≠ –†–æ–∑–≤–∞–∂–∞–ª—å–Ω–∏–π</option>
                            <option value="professional" {{ 'selected' if ai_settings.blogger_style == 'professional' else '' }}>üíº –ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="blogger_language">–ú–æ–≤–∞ —Å—Ç–∞—Ç–µ–π</label>
                        <select id="blogger_language" name="blogger_language">
                            <option value="uk" {{ 'selected' if ai_settings.blogger_language == 'uk' else '' }}>üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
                            <option value="en" {{ 'selected' if ai_settings.blogger_language == 'en' else '' }}>üá¨üáß English</option>
                            <option value="de" {{ 'selected' if ai_settings.blogger_language == 'de' else '' }}>üá©üá™ Deutsch</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3>üìè –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ —Å—Ç–∞—Ç–µ–π</h3>
                </div>
                <div class="form-section">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="blogger_min_words">–ú—ñ–Ω. —Å–ª—ñ–≤</label>
                            <input type="number" id="blogger_min_words" name="blogger_min_words" 
                                   value="{{ ai_settings.blogger_min_words or 500 }}" min="200" max="3000">
                        </div>
                        <div class="form-group">
                            <label for="blogger_max_words">–ú–∞–∫—Å. —Å–ª—ñ–≤</label>
                            <input type="number" id="blogger_max_words" name="blogger_max_words" 
                                   value="{{ ai_settings.blogger_max_words or 1500 }}" min="300" max="5000">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="toggle-label">
                            <input type="checkbox" name="auto_publish" {{ 'checked' if ai_settings.auto_publish else '' }}>
                            <span class="toggle-switch"></span>
                            –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—è
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="publish_time">–ß–∞—Å –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó</label>
                        <input type="time" id="publish_time" name="publish_time" 
                               value="{{ ai_settings.publish_time or '10:00' }}">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∑–æ–±—Ä–∞–∂–µ–Ω—å -->
        <div class="card" style="margin-top: 1.5rem;">
            <div class="card-header">
                <h3>üñºÔ∏è –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∑–æ–±—Ä–∞–∂–µ–Ω—å (DALL-E)</h3>
            </div>
            <div class="form-section">
                <div class="form-group">
                    <label class="toggle-label">
                        <input type="checkbox" name="generate_images" {{ 'checked' if ai_settings.generate_images else '' }}>
                        <span class="toggle-switch"></span>
                        –ì–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–ª—è —Å—Ç–∞—Ç–µ–π
                    </label>
                    <small class="form-hint">–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î DALL-E 3 –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –∑–æ–±—Ä–∞–∂–µ–Ω—å –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–º—ñ—Å—Ç—É —Å—Ç–∞—Ç—Ç—ñ</small>
                </div>
                <div class="form-group">
                    <label for="image_style">–°—Ç–∏–ª—å –∑–æ–±—Ä–∞–∂–µ–Ω—å</label>
                    <input type="text" id="image_style" name="image_style" 
                           value="{{ ai_settings.image_style or 'professional photography, realistic, high quality' }}" 
                           placeholder="professional photography, realistic, high quality">
                    <small class="form-hint">–û–ø–∏—Å —Å—Ç–∏–ª—é –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó (–∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—é). –ü—Ä–∏–∫–ª–∞–¥–∏: "minimalist, clean design", "vibrant colors, modern", "corporate style, professional"</small>
                </div>
            </div>
        </div>

        <div class="card" style="margin-top: 1.5rem;">
            <div class="card-header">
                <h3>üîç SEO –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</h3>
            </div>
            <div class="form-section">
                <div class="form-group">
                    <label for="blogger_default_keywords">–ë–∞–∑–æ–≤—ñ –∫–ª—é—á–æ–≤—ñ —Å–ª–æ–≤–∞</label>
                    <textarea id="blogger_default_keywords" name="blogger_default_keywords" rows="3" 
                              placeholder="–º–∞–≥–∞–∑–∏–Ω, –ø–æ–∫—É–ø–∫–∏ –æ–Ω–ª–∞–π–Ω, –¥–æ—Å—Ç–∞–≤–∫–∞...">{{ ai_settings.blogger_default_keywords or '' }}</textarea>
                    <small class="form-hint">–ö–ª—é—á–æ–≤—ñ —Å–ª–æ–≤–∞, —â–æ –¥–æ–¥–∞—é—Ç—å—Å—è –¥–æ –∫–æ–∂–Ω–æ—ó —Å—Ç–∞—Ç—Ç—ñ</small>
                </div>
                <div class="form-group">
                    <label for="blogger_seo_instructions">SEO —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó</label>
                    <textarea id="blogger_seo_instructions" name="blogger_seo_instructions" rows="8" 
                              placeholder="–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó —â–æ–¥–æ SEO-–æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó —Å—Ç–∞—Ç–µ–π...">{{ ai_settings.blogger_seo_instructions or '' }}</textarea>
                </div>
                <div class="form-group">
                    <label for="blogger_article_structure">–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç–∞—Ç—Ç—ñ</label>
                    <textarea id="blogger_article_structure" name="blogger_article_structure" rows="6" 
                              placeholder="1. –ó–∞–≥–æ–ª–æ–≤–æ–∫ H1
2. –í—Å—Ç—É–ø
3. –ü—ñ–¥–∑–∞–≥–æ–ª–æ–≤–∫–∏ H2
4. –í–∏—Å–Ω–æ–≤–æ–∫">{{ ai_settings.blogger_article_structure or '' }}</textarea>
                </div>
            </div>
        </div>
    </div>

    <div class="form-footer">
        <button type="submit" class="btn btn-primary btn-lg">
            <span>üíæ</span> –ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
        </button>
    </div>
</form>

<style>
.tabs {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
    border-bottom: 1px solid rgba(148, 163, 184, 0.3);
    padding-bottom: 0.5rem;
}

.tab {
    padding: 0.75rem 1.5rem;
    border: none;
    background: transparent;
    color: var(--text-muted);
    cursor: pointer;
    font-size: 0.95rem;
    border-radius: 0.5rem 0.5rem 0 0;
    transition: all 0.2s;
}

.tab:hover {
    color: var(--text-main);
    background: rgba(148, 163, 184, 0.1);
}

.tab.active {
    color: var(--accent);
    background: rgba(16, 185, 129, 0.1);
    border-bottom: 2px solid var(--accent);
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
}

.cards-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 1.5rem;
}

.form-section {
    padding: 1.5rem;
}

.form-group {
    margin-bottom: 1.25rem;
}

.form-group:last-child {
    margin-bottom: 0;
}

.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}

.form-hint {
    display: block;
    margin-top: 0.5rem;
    color: var(--text-muted);
    font-size: 0.85rem;
}

.toggle-label {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    cursor: pointer;
    font-weight: 500;
}

.toggle-label input {
    display: none;
}

.toggle-switch {
    width: 48px;
    height: 26px;
    background: rgba(148, 163, 184, 0.3);
    border-radius: 999px;
    position: relative;
    transition: background 0.2s;
}

.toggle-switch::after {
    content: "";
    position: absolute;
    width: 22px;
    height: 22px;
    background: white;
    border-radius: 50%;
    top: 2px;
    left: 2px;
    transition: transform 0.2s;
}

.toggle-label input:checked + .toggle-switch {
    background: var(--accent);
}

.toggle-label input:checked + .toggle-switch::after {
    transform: translateX(22px);
}

.form-footer {
    display: flex;
    justify-content: flex-end;
    padding: 1.5rem 0;
}

.btn-lg {
    padding: 1rem 2rem;
    font-size: 1.1rem;
}

input[type="range"] {
    width: 100%;
    margin-bottom: 0.5rem;
}

#temp-value {
    display: inline-block;
    padding: 0.25rem 0.5rem;
    background: rgba(148, 163, 184, 0.2);
    border-radius: 0.25rem;
    font-size: 0.85rem;
}

@media (max-width: 900px) {
    .cards-grid {
        grid-template-columns: 1fr;
    }
    
    .form-row {
        grid-template-columns: 1fr;
    }
}
</style>

<script>
function showTab(tabName) {
    // –ü—Ä–∏–±–∏—Ä–∞—î–º–æ active –∑ —É—Å—ñ—Ö —Ç–∞–±—ñ–≤
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    
    // –ê–∫—Ç–∏–≤—É—î–º–æ –ø–æ—Ç—Ä—ñ–±–Ω–∏–π
    document.querySelector(`[onclick="showTab('${tabName}')"]`).classList.add('active');
    document.getElementById(`tab-${tabName}`).classList.add('active');
}
</script>
{% endblock %}
