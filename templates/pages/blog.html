{% extends 'base.html' %}
{% block title %}{{ settings.blog_title or '–ë–ª–æ–≥' }} ‚Äì {{ settings.site_name or 'SmartShop AI' }}{% endblock %}

{% block extra_head %}
<meta name="description" content="{{ settings.blog_excerpt or '–ö–æ—Ä–∏—Å–Ω—ñ —Å—Ç–∞—Ç—Ç—ñ, –æ–≥–ª—è–¥–∏ —Ç–æ–≤–∞—Ä—ñ–≤ —Ç–∞ –Ω–æ–≤–∏–Ω–∏' }}">
{% endblock %}

{% block extra_styles %}
<style>
    .blog-hero {
        text-align: center;
        padding: 3rem 1rem;
        background: radial-gradient(circle at center, rgba(168, 85, 247, 0.15), transparent 70%);
        border-radius: 1.5rem;
        margin-bottom: 2rem;
    }

    .blog-hero h1 {
        font-size: 2.5rem;
        margin-bottom: 1rem;
        background: linear-gradient(120deg, #a855f7, #06b6d4, #22c55e);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
    }

    .blog-hero p {
        font-size: 1.1rem;
        color: var(--text-muted);
        max-width: 600px;
        margin: 0 auto;
    }

    .blog-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1.5rem;
    }

    .blog-card {
        border-radius: 1rem;
        border: 1px solid rgba(148, 163, 184, 0.45);
        background: rgba(15, 23, 42, 0.9);
        overflow: hidden;
        transition: transform 0.2s, box-shadow 0.2s;
        text-decoration: none;
        color: inherit;
        display: block;
    }

    .blog-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 12px 30px rgba(0,0,0,0.4);
    }

    .blog-card-image {
        height: 180px;
        background-size: cover;
        background-position: center;
        position: relative;
    }

    .blog-card-image::after {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(to top, rgba(15, 23, 42, 0.9), transparent);
    }

    .blog-card-content {
        padding: 1.25rem;
    }

    .blog-card-date {
        font-size: 0.75rem;
        color: var(--accent);
        margin-bottom: 0.5rem;
    }

    .blog-card h3 {
        font-size: 1.1rem;
        margin: 0 0 0.75rem;
        line-height: 1.4;
    }

    .blog-card p {
        font-size: 0.85rem;
        color: var(--text-muted);
        line-height: 1.5;
        margin: 0;
    }

    .blog-card-tags {
        display: flex;
        gap: 0.5rem;
        margin-top: 1rem;
        flex-wrap: wrap;
    }

    .blog-tag {
        font-size: 0.7rem;
        padding: 0.2rem 0.5rem;
        border-radius: 999px;
        background: rgba(148, 163, 184, 0.15);
        color: var(--text-muted);
    }

    .featured-post {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        margin-bottom: 2rem;
        padding: 1.5rem;
        border-radius: 1rem;
        border: 1px solid rgba(148, 163, 184, 0.45);
        background: rgba(15, 23, 42, 0.9);
        text-decoration: none;
        color: inherit;
        transition: transform 0.2s, box-shadow 0.2s;
    }

    .featured-post:hover {
        transform: translateY(-4px);
        box-shadow: 0 12px 30px rgba(0,0,0,0.4);
    }

    .featured-image {
        border-radius: 0.75rem;
        overflow: hidden;
        height: 300px;
    }

    .featured-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .featured-content {
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .featured-badge {
        display: inline-block;
        font-size: 0.7rem;
        padding: 0.25rem 0.75rem;
        border-radius: 999px;
        background: linear-gradient(135deg, #a855f7, #06b6d4);
        color: white;
        margin-bottom: 1rem;
        width: fit-content;
    }

    .featured-content h2 {
        font-size: 1.5rem;
        margin: 0 0 1rem;
    }

    .featured-content p {
        color: var(--text-muted);
        line-height: 1.6;
        margin-bottom: 1.5rem;
    }

    .ai-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.25rem;
        font-size: 0.7rem;
        padding: 0.15rem 0.4rem;
        background: rgba(168, 85, 247, 0.2);
        color: #a855f7;
        border-radius: 0.25rem;
        margin-left: 0.5rem;
    }

    .empty-state {
        text-align: center;
        padding: 4rem 2rem;
        border: 1px dashed rgba(148, 163, 184, 0.45);
        border-radius: 1rem;
    }

    .empty-state-icon {
        font-size: 4rem;
        margin-bottom: 1rem;
    }

    .empty-state h3 {
        margin: 0 0 0.5rem;
        color: var(--text-main);
    }

    .empty-state p {
        color: var(--text-muted);
        margin: 0;
    }

    .pagination {
        display: flex;
        justify-content: center;
        gap: 0.5rem;
        margin-top: 2rem;
    }

    .page-btn {
        padding: 0.5rem 0.75rem;
        border-radius: 0.5rem;
        background: rgba(148, 163, 184, 0.1);
        color: var(--text-muted);
        text-decoration: none;
    }

    .page-btn:hover, .page-btn.active {
        background: var(--accent);
        color: white;
    }

    .ai-notice {
        text-align: center;
        padding: 2rem;
        border-radius: 1rem;
        border: 1px dashed rgba(148, 163, 184, 0.45);
        margin-top: 2rem;
    }

    .ai-notice h3 {
        margin-top: 0;
        color: var(--accent);
    }

    @media (max-width: 920px) {
        .blog-grid {
            grid-template-columns: repeat(2, 1fr);
        }

        .featured-post {
            grid-template-columns: 1fr;
        }
    }

    @media (max-width: 640px) {
        .blog-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}

{% block content %}
<section>
    <div class="breadcrumb">
        <a href="{{ url_for('index') }}">–ì–æ–ª–æ–≤–Ω–∞</a>
        <span>/</span>
        <span style="color: var(--text-main);">–ë–ª–æ–≥</span>
    </div>

    <div class="blog-hero">
        <h1>{{ settings.blog_title or '–ë–ª–æ–≥ SmartShop AI' }}</h1>
        <p>{{ settings.blog_excerpt or '–ö–æ—Ä–∏—Å–Ω—ñ —Å—Ç–∞—Ç—Ç—ñ, –æ–≥–ª—è–¥–∏ —Ç–æ–≤–∞—Ä—ñ–≤ —Ç–∞ –Ω–æ–≤–∏–Ω–∏ –Ω–∞—à–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω—É' }}</p>
    </div>

    {% if featured_post %}
    <!-- Featured Post -->
    <a href="{{ url_for('blog_post_page', slug=featured_post.slug) }}" class="featured-post">
        <div class="featured-image">
            {% if featured_post.featured_image %}
            <img src="{{ featured_post.featured_image }}" alt="{{ featured_post.title }}">
            {% else %}
            <div style="width:100%;height:100%;background:radial-gradient(circle at top, rgba(52, 211, 153, 0.2), rgba(15, 23, 42, 1));display:flex;align-items:center;justify-content:center;font-size:4rem;">üìù</div>
            {% endif %}
        </div>
        <div class="featured-content">
            <span class="featured-badge">‚ú® –û–±—Ä–∞–Ω–µ</span>
            <h2>
                {{ featured_post.title }}
                {% if featured_post.is_ai_generated %}
                <span class="ai-badge">ü§ñ AI</span>
                {% endif %}
            </h2>
            <p>{{ featured_post.excerpt or (featured_post.content[:200] + '...' if featured_post.content else '') }}</p>
            <span class="btn">–ß–∏—Ç–∞—Ç–∏ –¥–∞–ª—ñ ‚Üí</span>
        </div>
    </a>
    {% endif %}

    {% if posts %}
    <h2 style="margin-bottom: 1rem;">–û—Å—Ç–∞–Ω–Ω—ñ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó</h2>

    <div class="blog-grid">
        {% for post in posts %}
        <a href="{{ url_for('blog_post_page', slug=post.slug) }}" class="blog-card">
            <div class="blog-card-image" style="background-image: url('{{ post.featured_image or 'https://images.pexels.com/photos/3184292/pexels-photo-3184292.jpeg?auto=compress&cs=tinysrgb&w=600' }}');"></div>
            <div class="blog-card-content">
                <div class="blog-card-date">
                    {{ post.publish_date.strftime('%d.%m.%Y') if post.publish_date else post.created_at.strftime('%d.%m.%Y') }}
                    {% if post.is_ai_generated %}
                    <span class="ai-badge">ü§ñ</span>
                    {% endif %}
                </div>
                <h3>{{ post.title }}</h3>
                <p>{{ (post.excerpt[:120] if post.excerpt else (post.content[:120] if post.content else '')) }}...</p>
                {% if post.keywords %}
                <div class="blog-card-tags">
                    {% for tag in post.keywords.split(',')[:3] %}
                    <span class="blog-tag">{{ tag.strip() }}</span>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
        </a>
        {% endfor %}
    </div>

    {% if total_pages > 1 %}
    <div class="pagination">
        {% for p in range(1, total_pages + 1) %}
        <a href="{{ url_for('blog_page', page=p) }}" class="page-btn {{ 'active' if p == page else '' }}">{{ p }}</a>
        {% endfor %}
    </div>
    {% endif %}

    {% elif not featured_post %}
    <div class="empty-state">
        <div class="empty-state-icon">üìù</div>
        <h3>–©–µ –Ω–µ–º–∞—î –ø—É–±–ª—ñ–∫–∞—Ü—ñ–π</h3>
        <p>–°–∫–æ—Ä–æ —Ç—É—Ç –∑'—è–≤–ª—è—Ç—å—Å—è —Ü—ñ–∫–∞–≤—ñ —Å—Ç–∞—Ç—Ç—ñ!</p>
    </div>
    {% endif %}

    <div class="ai-notice">
        <h3>ü§ñ –ë–ª–æ–≥ –Ω–∞ –±–∞–∑—ñ –Ü–Ü</h3>
        <p style="color: var(--text-muted);">–ù–∞—à –±–ª–æ–≥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≥–µ–Ω–µ—Ä—É—î —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç –∑–∞ –∫–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω–æ–º.<br>–£—Å—ñ —Å—Ç–∞—Ç—Ç—ñ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å—Å—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º –ø–µ—Ä–µ–¥ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—î—é.</p>
        <p style="color: var(--text-muted); font-size: 0.85rem;">–ù–∞–ª–∞—à—Ç—É–π—Ç–µ —Ç–µ–º–∏ —Ç–∞ —Å—Ç–∏–ª—å —É <a href="{{ url_for('admin_ai_settings') }}" style="color: var(--accent);">–∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—ñ</a></p>
    </div>
</section>
{% endblock %}
